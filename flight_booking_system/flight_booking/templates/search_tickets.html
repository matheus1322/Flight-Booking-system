{% extends 'base.html' %}

{% block content %}
  <h1>Search Tickets</h1>

  <form method="GET" action="{% url 'search_tickets' %}">
    <label for="ticket_code">Ticket Code:</label>
    <input type="text" name="ticket_code">
    <button type="submit">Search</button>
  </form>
    {% if messages %}
      <ul class="messages">
        {% for message in messages %}
          <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
        {% endfor %}
      </ul>
    {% endif %}
  <h1>Tickets</h1>
  <table>
  {% for booking in bookings %}
    <tr>
     <th>Ticket Code</th>
     <td>{{ booking.ticket_code }}</td>
    </tr>
  
    <tr>
      <th>Username</th>
      <td>{{ booking.username }}</td>
    </tr>
    <tr>

    <tr>
      <th>Economy Tickets</th>
      <td>{{ booking.number_of_tickets_economy }}</td>
    </tr>

    <tr>
      <th>First Class Tickets</th>
      <td>{{ booking.number_of_tickets_first_class }}</td>
    </tr>
    <tr>
    <tr>
      <th>Premium Economy Tickets</th>
      <td>{{ booking.number_of_tickets_premium_economy }}</td>
    </tr>
    <tr>
      <th>Total Price</th>
      <td>{{ booking.total_price }}</td>
    </tr>
   {% endfor %}
  </table>

  {% if user.is_superuser %}
    <h1>All Tickets</h1>
    <table>
      <thead>
        <tr>
          <th>Ticket Code</th>
          <th>Username</th>
          <th>Economy Tickets</th>
          <th>First Class Tickets</th>
          <th>Premium Economy Tickets</th>
          <th>Total Price</th>
        </tr>
      </thead>
      <tbody>
        {% for booking in bookings %}
          <tr>
            <td>{{ booking.ticket_code }}</td>
            <td>{{ booking.username }}</td>
            <td>{{ booking.number_of_tickets_economy }}</td>
            <td>{{ booking.number_of_tickets_first_class }}</td>
            <td>{{ booking.number_of_tickets_premium_economy }}</td>
            <td>{{ booking.total_price }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>You are not authorized to view all tickets.</p>
  {% endif %}
{% endblock %}
